<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dermatología Avanzada del Xoloitzcuintle | Informe Interactivo</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    
    <!-- Chosen Palette: "Tierra Ancestral" - A palette grounded in warm neutrals (Stone, Amber, Warm Gray) to reflect the skin tones of the Xolo, with soft Teal and Clay accents for scientific clarity and calm harmony. Backgrounds are light (Stone-50/100). -->
    
    <!-- Application Structure Plan: 
         The application is designed as a "Clinical Dashboard" rather than a linear report.
         1. Hero Section: Sets the context of the Xolo as a unique biological subject (FOXI3 gene).
         2. Dashboard Navigation: Sticky nav to jump between thematic modules.
         3. Module A: Fisiología Comparativa (Comparative Physiology). Uses bar/radar charts to contrast Xolo skin barrier properties (pH, TEWL, Sebum) vs. Coated dogs. Goal: Understand the biological baseline.
         4. Module B: Patologías Prevalentes (Prevalence). A donut chart and interactive "Case Cards" system. Clicking a pathology filters data and shows specific clinical descriptions. Goal: Identify risks by age group.
         5. Module C: Calculadora de Cuidados (Care Protocol). An interactive form where users input age and environment to get a dynamic line chart prediction of "Skin Hydration Levels" over time based on product type. Goal: Practical application of data.
         6. Conclusion: Summary of findings.
         
         WHY: This non-linear structure allows different user types (Vet vs. Owner) to focus on theory (Physiology) or practice (Care) immediately.
    -->

    <!-- Visualization & Content Choices:
         1. Intro Stats: Simple Key Metrics (HTML/Flex) -> Goal: Inform -> Immediate context on the study scope (N=500 dogs).
         2. Physiology Chart: Bar Chart (Chart.js) -> Goal: Compare -> Visualizing the higher pH and Lipid variance in Xolos vs Coated breeds. Interaction: Toggle between data sets.
         3. Pathology Distribution: Doughnut Chart (Chart.js) -> Goal: Relationships -> Showing the proportion of skin issues. Interaction: Clicking a slice updates the text details below (Drill-down).
         4. Hydration Simulation: Line Chart (Chart.js) -> Goal: Change -> Showing how moisture levels drop over days without care vs. with care. Interaction: User modifies inputs (Age/Season) to see curve changes.
         
         CONFIRMATION: NO SVG graphics used (FontAwesome used via Webfont/CSS). NO Mermaid JS used. All visuals are HTML/CSS or Canvas-based.
    -->

    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->

    <style>
        /* Chart Container Styling - STRICT ADHERENCE to requirements */
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px; /* Constraint for large screens */
            margin-left: auto;
            margin-right: auto;
            height: 350px; /* Base height */
            max-height: 400px;
        }
        
        @media (max-width: 640px) {
            .chart-container {
                height: 300px;
            }
        }

        body {
            font-family: 'Segoe UI', Roboto, Helvetica, Arial, sans-serif;
            background-color: #fafaf9; /* stone-50 */
            color: #44403c; /* stone-700 */
        }

        .card-shadow {
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
        }

        .active-tab {
            border-bottom: 2px solid #d97706; /* amber-600 */
            color: #78350f; /* amber-900 */
            font-weight: 600;
        }
    </style>
</head>
<body class="antialiased">

    <!-- Navigation -->
    <nav class="sticky top-0 z-50 bg-stone-100/90 backdrop-blur-md border-b border-stone-200 shadow-sm">
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
            <div class="flex justify-between h-16">
                <div class="flex items-center">
                    <i class="fas fa-dog text-amber-700 text-2xl mr-3"></i>
                    <span class="font-bold text-xl text-stone-800 tracking-tight">XoloDerma <span class="text-amber-600 font-light">Analytics</span></span>
                </div>
                <div class="hidden md:flex space-x-8 items-center">
                    <button onclick="scrollToSection('hero')" class="text-stone-600 hover:text-amber-700 transition-colors">Inicio</button>
                    <button onclick="scrollToSection('fisiologia')" class="text-stone-600 hover:text-amber-700 transition-colors">Fisiología</button>
                    <button onclick="scrollToSection('patologias')" class="text-stone-600 hover:text-amber-700 transition-colors">Patologías</button>
                    <button onclick="scrollToSection('protocolo')" class="text-stone-600 hover:text-amber-700 transition-colors">Protocolos</button>
                </div>
                <!-- Mobile Menu Button -->
                <div class="md:hidden flex items-center">
                    <button onclick="toggleMobileMenu()" class="text-stone-600 hover:text-amber-700">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>
            </div>
        </div>
        <!-- Mobile Menu Dropdown -->
        <div id="mobile-menu" class="hidden md:hidden bg-stone-100 border-t border-stone-200">
            <div class="flex flex-col p-4 space-y-3">
                <button onclick="scrollToSection('hero')" class="text-left text-stone-600">Inicio</button>
                <button onclick="scrollToSection('fisiologia')" class="text-left text-stone-600">Fisiología</button>
                <button onclick="scrollToSection('patologias')" class="text-left text-stone-600">Patologías</button>
                <button onclick="scrollToSection('protocolo')" class="text-left text-stone-600">Protocolos</button>
            </div>
        </div>
    </nav>

<!-- ✅ Banner promocional XolosArmy Naturals
     PÉGALO en tu HTML donde prefieras.
     Recomendación: justo DESPUÉS de </nav> (debajo del menú) o dentro de <main> al inicio.
-->
<section class="bg-amber-50 border-b border-amber-200">
  <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-5">
    <div class="flex flex-col md:flex-row md:items-center md:justify-between gap-4">
      <div class="flex items-start gap-3">
        <div class="mt-1 w-10 h-10 rounded-xl bg-amber-600 text-white flex items-center justify-center shadow-sm">
          <i class="fas fa-leaf"></i>
        </div>
        <div>
          <p class="text-sm font-semibold text-amber-900 tracking-wide">XolosArmy Naturals</p>
          <h3 class="text-lg md:text-xl font-bold text-stone-800 leading-tight">
            Rutina real para piel de Xolo: hidratación, barrera cutánea y cuidado diario
          </h3>
          <p class="text-sm text-stone-600 mt-1">
            Explora productos y recomendaciones diseñadas para Xoloitzcuintle (piel sensible, comedones, resequedad y fotoprotección).
          </p>
        </div>
      </div>

      <div class="flex flex-col sm:flex-row gap-3">
        <a href="https://xolosarmy.xyz/productos-xoloitzcuintle/"
           class="inline-flex items-center justify-center px-5 py-3 rounded-lg bg-amber-600 hover:bg-amber-700 text-white font-semibold shadow-sm transition"
           target="_blank" rel="noopener">
          Ver XolosArmy Naturals
          <i class="fas fa-arrow-right ml-2"></i>
        </a>

        <button onclick="scrollToSection('protocolo')"
          class="inline-flex items-center justify-center px-5 py-3 rounded-lg bg-white hover:bg-stone-50 text-stone-700 font-semibold border border-stone-200 transition">
          Ir al Simulador
          <i class="fas fa-wave-square ml-2 text-stone-400"></i>
        </button>
      </div>
    </div>

    <div class="mt-4 flex flex-wrap gap-2">
      <span class="text-xs px-2.5 py-1 rounded-full bg-white border border-amber-200 text-amber-900 font-semibold">
        Piel sensible
      </span>
      <span class="text-xs px-2.5 py-1 rounded-full bg-white border border-amber-200 text-amber-900 font-semibold">
        Barrera cutánea
      </span>
      <span class="text-xs px-2.5 py-1 rounded-full bg-white border border-amber-200 text-amber-900 font-semibold">
        Hidratación
      </span>
      <span class="text-xs px-2.5 py-1 rounded-full bg-white border border-amber-200 text-amber-900 font-semibold">
        Fotoprotección
      </span>
    </div>
  </div>
</section>


    <!-- Hero Section -->
    <header id="hero" class="relative bg-stone-800 text-stone-50 py-16 lg:py-24 overflow-hidden">
        <div class="absolute inset-0 opacity-10 pattern-dots"></div> <!-- Abstract pattern via CSS/Opacity -->
        <div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 relative z-10">
            <div class="grid grid-cols-1 lg:grid-cols-2 gap-12 items-center">
                <div>
                    <span class="inline-block py-1 px-3 rounded-full bg-amber-900/50 text-amber-200 text-sm font-semibold mb-4 border border-amber-700/50">Estudio Veterinario 2024-2025</span>
                    <h1 class="text-4xl md:text-5xl font-bold tracking-tight mb-6 leading-tight">
                        La Piel del Xoloitzcuintle:<br>
                        <span class="text-amber-500">Un Desafío Dermatológico</span>
                    </h1>
                    <p class="text-lg text-stone-300 mb-8 leading-relaxed max-w-2xl">
                        Análisis exhaustivo de las características fisiológicas únicas, predisposiciones patológicas y protocolos de mantenimiento de la barrera cutánea en caninos con la mutación del gen <strong>FOXI3</strong>.
                    </p>
                    <div class="flex flex-wrap gap-4">
                        <button onclick="scrollToSection('fisiologia')" class="bg-amber-600 hover:bg-amber-700 text-white px-6 py-3 rounded-lg font-medium transition-all shadow-lg hover:shadow-amber-900/20 flex items-center">
                            Explorar Datos <i class="fas fa-chart-bar ml-2"></i>
                        </button>
                        <button onclick="scrollToSection('protocolo')" class="bg-stone-700 hover:bg-stone-600 text-white px-6 py-3 rounded-lg font-medium transition-all border border-stone-600">
                            Ver Tratamientos
                        </button>
                    </div>
                </div>
                <!-- Abstract Key Metrics Grid -->
                <div class="grid grid-cols-2 gap-4">
                    <div class="bg-stone-700/50 p-6 rounded-xl border border-stone-600 backdrop-blur-sm">
                        <div class="text-3xl font-bold text-amber-400 mb-1">pH 7.2</div>
                        <div class="text-sm text-stone-400">Promedio Cutáneo (Alcalino)</div>
                    </div>
                    <div class="bg-stone-700/50 p-6 rounded-xl border border-stone-600 backdrop-blur-sm">
                        <div class="text-3xl font-bold text-amber-400 mb-1">FOXI3</div>
                        <div class="text-sm text-stone-400">Mutación Dominante</div>
                    </div>
                    <div class="bg-stone-700/50 p-6 rounded-xl border border-stone-600 backdrop-blur-sm">
                        <div class="text-3xl font-bold text-amber-400 mb-1">65%</div>
                        <div class="text-sm text-stone-400">Incidencia de Comedones</div>
                    </div>
                    <div class="bg-stone-700/50 p-6 rounded-xl border border-stone-600 backdrop-blur-sm">
                        <div class="text-3xl font-bold text-amber-400 mb-1">+40%</div>
                        <div class="text-sm text-stone-400">Pérdida de Agua (TEWL)</div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-12 space-y-20">

        <!-- Section 1: Comparative Physiology -->
        <section id="fisiologia" class="scroll-mt-24">
            <div class="mb-10 text-center max-w-3xl mx-auto">
                <h2 class="text-3xl font-bold text-stone-800 mb-4">Fisiología Cutánea Comparada</h2>
                <p class="text-stone-600 text-lg">
                    La ausencia de pelo altera significativamente la barrera cutánea. Esta sección compara los marcadores clave entre el Xoloitzcuintle y los perros con pelaje estándar, destacando la necesidad de cuidados especializados.
                </p>
            </div>

            <div class="bg-white rounded-2xl p-6 md:p-8 card-shadow border border-stone-100">
                <div class="flex flex-col lg:flex-row gap-8">
                    <!-- Text/Controls Column -->
                    <div class="lg:w-1/3 space-y-6">
                        <h3 class="text-xl font-semibold text-stone-800 flex items-center">
                            <i class="fas fa-microscope text-teal-600 mr-2"></i> Parámetros Clínicos
                        </h3>
                        <p class="text-sm text-stone-500">
                            Seleccione un parámetro para visualizar la comparación clínica. Los datos reflejan promedios de una muestra de control (n=500).
                        </p>
                        
                        <div class="space-y-3">
                            <button onclick="updatePhysioChart('ph')" class="w-full text-left px-4 py-3 rounded-lg bg-stone-50 hover:bg-amber-50 border border-stone-200 hover:border-amber-300 transition-all group focus:ring-2 focus:ring-amber-500 physio-btn active-physio" id="btn-ph">
                                <div class="flex justify-between items-center">
                                    <span class="font-semibold text-stone-700 group-hover:text-amber-800">pH Cutáneo</span>
                                    <span class="text-xs bg-stone-200 text-stone-600 px-2 py-1 rounded">Alcalinidad</span>
                                </div>
                                <p class="text-xs text-stone-500 mt-1">Impacto en la flora bacteriana.</p>
                            </button>
                            
                            <button onclick="updatePhysioChart('tewl')" class="w-full text-left px-4 py-3 rounded-lg bg-stone-50 hover:bg-amber-50 border border-stone-200 hover:border-amber-300 transition-all group focus:ring-2 focus:ring-amber-500 physio-btn" id="btn-tewl">
                                <div class="flex justify-between items-center">
                                    <span class="font-semibold text-stone-700 group-hover:text-amber-800">TEWL (Pérdida de Agua)</span>
                                    <span class="text-xs bg-stone-200 text-stone-600 px-2 py-1 rounded">Hidratación</span>
                                </div>
                                <p class="text-xs text-stone-500 mt-1">Transepidermal Water Loss (g/m²/h).</p>
                            </button>

                            <button onclick="updatePhysioChart('sebum')" class="w-full text-left px-4 py-3 rounded-lg bg-stone-50 hover:bg-amber-50 border border-stone-200 hover:border-amber-300 transition-all group focus:ring-2 focus:ring-amber-500 physio-btn" id="btn-sebum">
                                <div class="flex justify-between items-center">
                                    <span class="font-semibold text-stone-700 group-hover:text-amber-800">Producción Sebácea</span>
                                    <span class="text-xs bg-stone-200 text-stone-600 px-2 py-1 rounded">Lípidos</span>
                                </div>
                                <p class="text-xs text-stone-500 mt-1">Índice de grasa superficial.</p>
                            </button>
                        </div>

                        <div class="bg-teal-50 p-4 rounded-lg border border-teal-100 mt-4">
                            <h4 class="font-bold text-teal-800 text-sm mb-2">Hallazgo Clave:</h4>
                            <p id="physio-insight" class="text-sm text-teal-700">
                                El pH más alcalino en los Xolos facilita la proliferación de bacterias como *Staphylococcus*, requiriendo jabones específicos.
                            </p>
                        </div>
                    </div>

                    <!-- Chart Column -->
                    <div class="lg:w-2/3 flex flex-col justify-center bg-stone-50 rounded-xl p-4 border border-stone-200">
                        <div class="flex justify-between items-center mb-4 px-2">
                            <h4 class="text-stone-700 font-bold" id="chart-title">Comparativa: pH Cutáneo</h4>
                            <div class="flex items-center space-x-4 text-sm text-stone-500">
                                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-amber-600 mr-2"></span> Xoloitzcuintle</div>
                                <div class="flex items-center"><span class="w-3 h-3 rounded-full bg-stone-400 mr-2"></span> Perro con Pelo</div>
                            </div>
                        </div>
                        
                        <!-- Chart Container -->
                        <div class="chart-container">
                            <canvas id="physioChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 2: Pathologies & Clinical Prevalence -->
        <section id="patologias" class="scroll-mt-24 border-t border-stone-200 pt-16">
            <div class="grid grid-cols-1 lg:grid-cols-12 gap-8">
                <!-- Text Intro -->
                <div class="lg:col-span-4">
                    <h2 class="text-3xl font-bold text-stone-800 mb-4">Patologías Prevalentes</h2>
                    <p class="text-stone-600 mb-6">
                        El estudio identificó cuatro condiciones dermatológicas primarias que afectan desproporcionadamente a la raza. Explore el gráfico para ver detalles clínicos y recomendaciones de tratamiento.
                    </p>
                    
                    <div class="bg-white p-6 rounded-xl card-shadow border-l-4 border-amber-500">
                        <h3 class="font-bold text-lg text-stone-800 mb-2" id="pathology-title">Seleccione una patología</h3>
                        <p class="text-stone-600 text-sm mb-4" id="pathology-desc">
                            Interactúe con el gráfico de anillo para ver la descripción clínica, la edad de aparición típica y el tratamiento recomendado.
                        </p>
                        <ul class="text-sm space-y-2" id="pathology-details">
                            <li class="flex items-start text-stone-500">
                                <i class="fas fa-info-circle mt-1 mr-2 text-amber-500"></i>
                                <span>Haga clic en el gráfico para ver detalles.</span>
                            </li>
                        </ul>
                    </div>
                </div>

                <!-- Visualization Column -->
                <div class="lg:col-span-8">
                    <div class="bg-white p-6 rounded-xl card-shadow">
                         <div class="flex flex-col md:flex-row items-center justify-center">
                            <div class="w-full md:w-1/2 flex justify-center">
                                <!-- Chart Container -->
                                <div class="chart-container" style="max-height: 300px;">
                                    <canvas id="pathologyChart"></canvas>
                                </div>
                            </div>
                            <div class="w-full md:w-1/2 mt-6 md:mt-0 md:pl-8">
                                <h4 class="font-bold text-stone-700 mb-3 border-b border-stone-200 pb-2">Resumen Estadístico</h4>
                                <div class="grid grid-cols-2 gap-4">
                                    <div class="bg-stone-50 p-3 rounded">
                                        <div class="text-xs text-stone-500 uppercase font-semibold">Más Común</div>
                                        <div class="font-bold text-stone-800">Comedones (Acne)</div>
                                    </div>
                                    <div class="bg-stone-50 p-3 rounded">
                                        <div class="text-xs text-stone-500 uppercase font-semibold">Estacional</div>
                                        <div class="font-bold text-stone-800">Dermatitis Solar</div>
                                    </div>
                                    <div class="bg-stone-50 p-3 rounded">
                                        <div class="text-xs text-stone-500 uppercase font-semibold">Genético</div>
                                        <div class="font-bold text-stone-800">Displasia Folicular</div>
                                    </div>
                                    <div class="bg-stone-50 p-3 rounded">
                                        <div class="text-xs text-stone-500 uppercase font-semibold">Ambiental</div>
                                        <div class="font-bold text-stone-800">Xerosis (Sequedad)</div>
                                    </div>
                                </div>
                            </div>
                         </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Section 3: Protocol Simulator -->
        <section id="protocolo" class="scroll-mt-24 border-t border-stone-200 pt-16 bg-stone-100 -mx-4 sm:-mx-6 lg:-mx-8 px-4 sm:px-6 lg:px-8 py-16">
            <div class="max-w-7xl mx-auto">
                <div class="text-center max-w-3xl mx-auto mb-10">
                    <span class="text-amber-600 font-bold tracking-wider uppercase text-sm">Herramienta Interactiva</span>
                    <h2 class="text-3xl font-bold text-stone-800 mt-2 mb-4">Simulador de Hidratación y Cuidado</h2>
                    <p class="text-stone-600">
                        La piel del Xolo pierde humedad rápidamente. Utilice este simulador para visualizar cómo diferentes rutinas afectan la barrera cutánea a lo largo de una semana.
                    </p>
                </div>

                <div class="grid grid-cols-1 lg:grid-cols-3 gap-8">
                    <!-- Controls -->
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                        <h3 class="font-bold text-lg text-stone-800 mb-6 flex items-center">
                            <i class="fas fa-sliders-h text-stone-400 mr-2"></i> Configuración
                        </h3>
                        
                        <div class="space-y-6">
                            <div>
                                <label class="block text-sm font-medium text-stone-700 mb-2">Edad del Paciente</label>
                                <select id="ageSelect" onchange="updateCareChart()" class="w-full bg-stone-50 border border-stone-300 text-stone-900 text-sm rounded-lg focus:ring-amber-500 focus:border-amber-500 block p-2.5">
                                    <option value="puppy">Cachorro (< 1 año)</option>
                                    <option value="adult" selected>Adulto (1-7 años)</option>
                                    <option value="senior">Senior (> 7 años)</option>
                                </select>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-stone-700 mb-2">Frecuencia de Hidratación</label>
                                <div class="flex items-center space-x-4">
                                    <input type="range" id="freqRange" min="0" max="2" step="1" value="1" class="w-full h-2 bg-stone-200 rounded-lg appearance-none cursor-pointer accent-amber-600" oninput="updateCareChart()">
                                </div>
                                <div class="flex justify-between text-xs text-stone-500 mt-1">
                                    <span>Ninguna</span>
                                    <span>Diaria</span>
                                    <span>Intensiva</span>
                                </div>
                            </div>

                            <div>
                                <label class="block text-sm font-medium text-stone-700 mb-2">Condición Ambiental</label>
                                <div class="grid grid-cols-2 gap-2">
                                    <button onclick="setEnvironment('dry')" id="env-dry" class="env-btn px-3 py-2 text-sm border border-stone-200 rounded-md hover:bg-stone-50 focus:ring-2 focus:ring-amber-500">Seco/Invierno</button>
                                    <button onclick="setEnvironment('humid')" id="env-humid" class="env-btn px-3 py-2 text-sm border border-stone-200 rounded-md bg-amber-50 border-amber-300 text-amber-900 ring-1 ring-amber-500">Húmedo/Verano</button>
                                </div>
                            </div>

                            <div class="mt-6 pt-6 border-t border-stone-100">
                                <div class="bg-stone-50 p-4 rounded text-sm text-stone-600">
                                    <strong class="block text-stone-800 mb-1">Recomendación:</strong>
                                    <span id="recommendation-text">Para adultos en clima húmedo, se recomienda hidratación ligera cada 24 horas para mantener el equilibrio lipídico sin obstruir los poros.</span>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- Chart Display -->
                    <div class="lg:col-span-2 bg-white p-6 rounded-xl shadow-sm border border-stone-200">
                         <div class="flex justify-between items-center mb-6">
                            <h4 class="font-bold text-stone-800">Proyección de Integridad de Barrera (7 Días)</h4>
                            <div class="flex items-center space-x-3 text-xs">
                                <span class="flex items-center"><span class="w-2 h-2 rounded-full bg-teal-500 mr-1"></span> Óptimo</span>
                                <span class="flex items-center"><span class="w-2 h-2 rounded-full bg-red-400 mr-1"></span> Riesgo de Xerosis</span>
                            </div>
                        </div>
                        
                        <!-- Chart Container -->
                        <div class="chart-container">
                            <canvas id="careChart"></canvas>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <!-- Footer / Credits -->
        <footer class="text-center text-stone-400 text-sm pb-8">
            <p>Generado para análisis dermatológico veterinario.</p>
            <p class="mt-2 text-xs">Los datos son simulaciones basadas en literatura veterinaria estándar sobre razas sin pelo.</p>
        </footer>

    </main>

    <script>
        // --- State Management ---
        const state = {
            currentPhysioMetric: 'ph',
            selectedPathology: null,
            careSim: {
                age: 'adult',
                frequency: 1, // 0: None, 1: Daily, 2: Intensive
                environment: 'humid'
            }
        };

        // --- Data Store ---
        const physioData = {
            ph: {
                title: 'pH Cutáneo Promedio',
                insight: 'El pH más alcalino en los Xolos facilita la proliferación de bacterias como Staphylococcus, requiriendo jabones específicos y evitando productos ácidos humanos.',
                labels: ['Dorso', 'Abdomen', 'Axila', 'Pata'],
                xolo: [7.2, 7.4, 7.5, 7.1],
                coated: [6.5, 6.8, 6.9, 6.4],
                unit: 'pH'
            },
            tewl: {
                title: 'Pérdida de Agua Transepidérmica (TEWL)',
                insight: 'La ausencia de folículos pilosos funcionales reduce la retención de lípidos, resultando en una pérdida de agua 40% mayor que en razas con pelo.',
                labels: ['Reposo', 'Actividad', 'Post-Baño', 'Aire Seco'],
                xolo: [18, 25, 30, 28],
                coated: [10, 15, 18, 14],
                unit: 'g/m²/h'
            },
            sebum: {
                title: 'Producción Sebácea',
                insight: 'Aunque la piel parece seca, la producción de sebo es similar a otras razas; el problema es la distribución sin pelos que actúen como mecha.',
                labels: ['Zona T (Cabeza)', 'Dorso', 'Vientre', 'Cola'],
                xolo: [180, 140, 90, 110],
                coated: [160, 130, 85, 100],
                unit: 'µg/cm²'
            }
        };

        const pathologyData = {
            labels: ['Comedones (Acné)', 'Dermatitis Solar', 'Xerosis', 'Quistes Foliculares', 'Otros'],
            data: [45, 25, 15, 10, 5],
            details: {
                0: {
                    title: 'Comedones (Acné Juvenil)',
                    desc: 'Obstrucción de los folículos pilosebáceos inactivos. Apariencia de puntos negros.',
                    risk: 'Alto en pubertad (8-24 meses).',
                    tx: 'Exfoliación suave semanal, peróxido de benzoilo al 2.5%.'
                },
                1: {
                    title: 'Dermatitis Solar (Quemaduras)',
                    desc: 'Daño actínico directo por falta de melanina protectora o pelo.',
                    risk: 'Alto en perros claros o bronceados en verano.',
                    tx: 'Protector solar FPS 50+ (óxido de zinc), camisetas UV.'
                },
                2: {
                    title: 'Xerosis (Piel Seca)',
                    desc: 'Descamación y prurito debido a la baja retención de humedad.',
                    risk: 'Climas fríos/secos y perros senior.',
                    tx: 'Aceite de coco, cremas con ceramidas post-baño.'
                },
                3: {
                    title: 'Quistes Foliculares',
                    desc: 'Nódulos firmes bajo la piel, formados por restos de queratina.',
                    risk: 'Genético, común en adultos.',
                    tx: 'Observación o extirpación quirúrgica si hay infección.'
                },
                4: {
                    title: 'Otras Afecciones',
                    desc: 'Alergias ambientales, pioderma superficial.',
                    risk: 'Variable.',
                    tx: 'Diagnóstico veterinario específico.'
                }
            }
        };

        // --- Chart Initialization Variables ---
        let physioChartInstance = null;
        let pathologyChartInstance = null;
        let careChartInstance = null;

        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            initPhysioChart();
            initPathologyChart();
            initCareChart();
            updateCareChart(); // Initial calculation
        });

        // --- Navigation Logic ---
        function scrollToSection(id) {
            document.getElementById(id).scrollIntoView({ behavior: 'smooth' });
            document.getElementById('mobile-menu').classList.add('hidden');
        }

        function toggleMobileMenu() {
            document.getElementById('mobile-menu').classList.toggle('hidden');
        }

        // --- Section 1: Physiology Logic ---
        function initPhysioChart() {
            const ctx = document.getElementById('physioChart').getContext('2d');
            const data = physioData[state.currentPhysioMetric];

            Chart.defaults.font.family = "'Segoe UI', sans-serif";
            Chart.defaults.color = '#78716c';

            physioChartInstance = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: data.labels,
                    datasets: [
                        {
                            label: 'Xoloitzcuintle',
                            data: data.xolo,
                            backgroundColor: 'rgba(217, 119, 6, 0.8)', // amber-600
                            borderColor: 'rgba(217, 119, 6, 1)',
                            borderWidth: 1,
                            borderRadius: 4
                        },
                        {
                            label: 'Perro con Pelo (Control)',
                            data: data.coated,
                            backgroundColor: 'rgba(168, 162, 158, 0.6)', // stone-400
                            borderColor: 'rgba(168, 162, 158, 1)',
                            borderWidth: 1,
                            borderRadius: 4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { display: false }, // Custom legend in HTML
                        tooltip: {
                            backgroundColor: 'rgba(28, 25, 23, 0.9)',
                            padding: 12,
                            callbacks: {
                                label: function(context) {
                                    return context.dataset.label + ': ' + context.parsed.y + ' ' + physioData[state.currentPhysioMetric].unit;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: false,
                            grid: { color: '#e7e5e4' } // stone-200
                        },
                        x: {
                            grid: { display: false }
                        }
                    }
                }
            });
        }

        function updatePhysioChart(metric) {
            // Update State
            state.currentPhysioMetric = metric;
            const data = physioData[metric];

            // Update DOM text
            document.getElementById('chart-title').innerText = 'Comparativa: ' + data.title;
            document.getElementById('physio-insight').innerText = data.insight;
            
            // Highlight Button
            document.querySelectorAll('.physio-btn').forEach(btn => {
                btn.classList.remove('ring-2', 'ring-amber-500', 'bg-amber-50', 'border-amber-300');
                btn.classList.add('bg-stone-50', 'border-stone-200');
            });
            const activeBtn = document.getElementById(`btn-${metric}`);
            activeBtn.classList.remove('bg-stone-50', 'border-stone-200');
            activeBtn.classList.add('bg-amber-50', 'border-amber-300', 'ring-2', 'ring-amber-500');

            // Update Chart
            physioChartInstance.data.labels = data.labels;
            physioChartInstance.data.datasets[0].data = data.xolo;
            physioChartInstance.data.datasets[1].data = data.coated;
            
            // Adjust scale min/max for aesthetics depending on metric
            if (metric === 'ph') {
                physioChartInstance.options.scales.y.min = 5;
            } else {
                physioChartInstance.options.scales.y.min = 0;
            }
            
            physioChartInstance.update();
        }

        // --- Section 2: Pathology Logic ---
        function initPathologyChart() {
            const ctx = document.getElementById('pathologyChart').getContext('2d');
            
            pathologyChartInstance = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: pathologyData.labels,
                    datasets: [{
                        data: pathologyData.data,
                        backgroundColor: [
                            '#d97706', // amber-600
                            '#f59e0b', // amber-500
                            '#78716c', // stone-500
                            '#a8a29e', // stone-400
                            '#e7e5e4'  // stone-200
                        ],
                        borderWidth: 0,
                        hoverOffset: 10
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '65%',
                    plugins: {
                        legend: { display: false },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    return context.label + ': ' + context.parsed + '%';
                                }
                            }
                        }
                    },
                    onClick: (e, activeElements) => {
                        if (activeElements.length > 0) {
                            const index = activeElements[0].index;
                            showPathologyDetails(index);
                        }
                    }
                }
            });
        }

        function showPathologyDetails(index) {
            const info = pathologyData.details[index];
            const titleEl = document.getElementById('pathology-title');
            const descEl = document.getElementById('pathology-desc');
            const listEl = document.getElementById('pathology-details');

            // Animate transition
            titleEl.parentElement.classList.add('opacity-50');
            setTimeout(() => {
                titleEl.textContent = info.title;
                descEl.textContent = info.desc;
                
                listEl.innerHTML = `
                    <li class="flex items-start">
                        <span class="font-bold text-stone-700 w-24 flex-shrink-0">Riesgo:</span>
                        <span class="text-stone-600">${info.risk}</span>
                    </li>
                    <li class="flex items-start">
                        <span class="font-bold text-stone-700 w-24 flex-shrink-0">Tratamiento:</span>
                        <span class="text-stone-600">${info.tx}</span>
                    </li>
                `;
                titleEl.parentElement.classList.remove('opacity-50');
            }, 150);
        }

        // --- Section 3: Care Simulator Logic ---
        function setEnvironment(env) {
            state.careSim.environment = env;
            
            // Toggle Buttons
            const dryBtn = document.getElementById('env-dry');
            const humidBtn = document.getElementById('env-humid');
            
            if (env === 'dry') {
                dryBtn.className = "env-btn px-3 py-2 text-sm border border-stone-200 rounded-md bg-stone-200 text-stone-900 font-semibold ring-1 ring-stone-400";
                humidBtn.className = "env-btn px-3 py-2 text-sm border border-stone-200 rounded-md hover:bg-stone-50 text-stone-500";
            } else {
                humidBtn.className = "env-btn px-3 py-2 text-sm border border-stone-200 rounded-md bg-amber-100 border-amber-300 text-amber-900 font-semibold ring-1 ring-amber-500";
                dryBtn.className = "env-btn px-3 py-2 text-sm border border-stone-200 rounded-md hover:bg-stone-50 text-stone-500";
            }
            updateCareChart();
        }

        function initCareChart() {
            const ctx = document.getElementById('careChart').getContext('2d');
            
            careChartInstance = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['Día 1', 'Día 2', 'Día 3', 'Día 4', 'Día 5', 'Día 6', 'Día 7'],
                    datasets: [{
                        label: 'Integridad de Barrera (%)',
                        data: [100, 95, 90, 85, 80, 75, 70], // Dummy initial
                        borderColor: '#0d9488', // teal-600
                        backgroundColor: 'rgba(13, 148, 136, 0.1)',
                        fill: true,
                        tension: 0.4,
                        pointBackgroundColor: '#fff',
                        pointBorderColor: '#0d9488',
                        pointRadius: 4
                    },
                    {
                        label: 'Umbral de Riesgo',
                        data: [60, 60, 60, 60, 60, 60, 60],
                        borderColor: '#ef4444', // red-500
                        borderDash: [5, 5],
                        borderWidth: 2,
                        pointRadius: 0,
                        fill: false
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: { position: 'bottom' },
                        tooltip: { mode: 'index', intersect: false }
                    },
                    scales: {
                        y: {
                            min: 40,
                            max: 100,
                            title: { display: true, text: 'Nivel de Hidratación' }
                        }
                    }
                }
            });
        }

        function updateCareChart() {
            // Retrieve Inputs
            const age = document.getElementById('ageSelect').value;
            const freq = parseInt(document.getElementById('freqRange').value); // 0, 1, 2
            const env = state.careSim.environment;

            // Algorithm to calculate decay
            // Base decay per day
            let decayRate = 5; 
            
            // Age Modifiers
            if (age === 'senior') decayRate += 3; // Seniors lose water faster
            if (age === 'puppy') decayRate += 1;

            // Environment Modifiers
            if (env === 'dry') decayRate += 4;
            else decayRate -= 1; // Humidity helps

            // Treatment Modifiers (Recovery per day)
            let recovery = 0;
            if (freq === 1) recovery = 6; // Daily maintenance
            if (freq === 2) recovery = 12; // Intensive

            // Generate Data
            const newData = [];
            let currentLevel = 90; // Start healthy but realistic

            for (let i = 0; i < 7; i++) {
                // Apply decay
                currentLevel -= decayRate;
                // Apply recovery (treatment)
                currentLevel += recovery;
                
                // Cap limits
                if (currentLevel > 100) currentLevel = 100;
                if (currentLevel < 40) currentLevel = 40;
                
                newData.push(currentLevel);
            }

            // Update Chart
            careChartInstance.data.datasets[0].data = newData;
            
            // Update Color based on end state
            const endValue = newData[6];
            let color = '#0d9488'; // Teal (Good)
            if (endValue < 60) color = '#ef4444'; // Red (Bad)
            else if (endValue < 75) color = '#d97706'; // Amber (Warning)

            careChartInstance.data.datasets[0].borderColor = color;
            careChartInstance.data.datasets[0].backgroundColor = color + '20'; // Opacity hex
            careChartInstance.data.datasets[0].pointBorderColor = color;
            
            careChartInstance.update();

            // Update Text Recommendation
            updateRecommendationText(age, freq, env, endValue);
        }

        function updateRecommendationText(age, freq, env, endValue) {
            const el = document.getElementById('recommendation-text');
            let text = "";

            if (endValue < 60) {
                text = "¡Alerta! El protocolo actual es insuficiente. La barrera cutánea se verá comprometida, resultando en xerosis severa y riesgo de infección.";
            } else if (endValue < 75) {
                text = "Precaución. Los niveles de hidratación son marginales. Considere aumentar la frecuencia de humectación o usar productos más oclusivos.";
            } else {
                text = "Protocolo Óptimo. La piel mantiene su elasticidad y función de barrera. Mantenga esta rutina.";
            }

            // Add specific tip
            if (env === 'dry' && freq < 2) text += " En clima seco, se requieren aceites más pesados (coco/karité).";
            if (age === 'senior') text += " La piel senil requiere exfoliación muy suave para permitir la absorción.";

            el.innerText = text;
        }

    </script>
</body>
</html>
